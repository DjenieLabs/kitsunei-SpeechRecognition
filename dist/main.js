"use strict";define(["HubLink","RIB","PropertiesPanel","Easy"],function(a,e,n,i){function t(a,e){var n=-1;return a.some(function(a,i){if(a.index==e)return n=i,!0}),n}function s(a){var e=this;this.languages.items.forEach(function(n){n.value==a?(e.languages.default=n.name,n.selected=!0):n.selected=!1})}function o(){var a=this,e=i.getValues();a.annyang.setLanguage(e.Languages),s.call(this,e.Languages);var n={};this.myPropertiesWindow.find(".record-row").each(function(e){var i=t(a.commands,$(this).attr("data-index")),s=$(this).find("input").val();a.commands[i].name=s,n[s]=m.bind(a,s)}),Object.keys(n).length&&this.annyang.addCommands(n)}function r(a){o.call(this);var e=this;e.commands.splice(t(e.commands,$(a).attr("data-index")),1),u.call(this)}function l(){o.call(this),this.commands.push({index:this.commands.length,name:"Add Command"}),u.call(this)}function u(){var a=this;n.clear(),n.stopLoading(),i.clearCustomSettingsPanel(),this.myPropertiesWindow=$(this.propTemplate({command:this.commands,Language:this.languages})),this.myPropertiesWindow.find("#btAdd").click(l.bind(this)),this.myPropertiesWindow.find("#btDelete").click(function(){r.call(a,this)}),this.myPropertiesWindow.find("#btResume").click(function(){a.annyang_started||(a.annyang.start(),a.annyang_started=!0,console.log("Voice Recognition lib resumed! ")),a.myPropertiesWindow.find("#btPause").show(),a.myPropertiesWindow.find("#btResume").hide()}),this.myPropertiesWindow.find("#btPause").click(function(){a.annyang_started&&(a.annyang.abort(),a.annyang_started=!1,console.log("Voice Recognition lib paused! ")),a.myPropertiesWindow.find("#btPause").hide(),a.myPropertiesWindow.find("#btResume").show()}),this.annyang_started?this.myPropertiesWindow.find("#btResume").hide():this.myPropertiesWindow.find("#btPause").hide(),this.myPropertiesWindow.find(".dropdown").dropdown(),i.displayCustomSettings(this.myPropertiesWindow,!0)}function m(a,e){a.split(":")[0].trim().toLowerCase();this.processData({commandmatch:!0});var n={};n[a.toLowerCase().trim()]=e,this.processData(n)}var c={settings:{Custom:{}},dataFeed:{}};return c.getActions=function(){return[]},c.isInputBlock=!0,c.getInputs=function(){var a=["SoundStarts","CommandMatch","ResultNoMatch"],e=!0,n=!1,i=void 0;try{for(var t,s=this.commands[Symbol.iterator]();!(e=(t=s.next()).done);e=!0){var o=t.value;a.push(o.name.toLowerCase())}}catch(a){n=!0,i=a}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return a},c.hideDataFeed=function(){return!1},c.onLoad=function(){var a=this,e=a.basePath+"assets/";this.languages={property:"Languages",default:"English (Australia)",items:[{name:"Afrikaans",value:"af"},{name:"Basque",value:"eu"},{name:"Bulgarian",value:"bg"},{name:"Catalan",value:"ca"},{name:"Arabic (Egypt)",value:"ar-EG"},{name:"Arabic (Jordan)",value:"ar-JO"},{name:"Arabic (Kuwait)",value:"ar-KW"},{name:"Arabic (Lebanon)",value:"ar-LB"},{name:"Arabic (Qatar)",value:"ar-QA"},{name:"Arabic (UAE)",value:"ar-AE"},{name:"Arabic (Morocco)",value:"ar-MA"},{name:"Arabic (Iraq)",value:"ar-IQ"},{name:"Arabic (Algeria)",value:"ar-DZ"},{name:"Arabic (Bahrain)",value:"ar-BH"},{name:"Arabic (Lybia)",value:"ar-LY"},{name:"Arabic (Oman)",value:"ar-OM"},{name:"Arabic (Saudi Arabia)",value:"ar-SA"},{name:"Arabic (Tunisia)",value:"ar-TN"},{name:"Arabic (Yemen)",value:"ar-YE"},{name:"Czech",value:"cs"},{name:"Dutch",value:"nl-NL"},{name:"English (Australia)",value:"en-AU",selected:!0},{name:"English (Canada)",value:"en-CA"},{name:"English (India)",value:"en-IN"},{name:"English (New Zealand)",value:"en-NZ"},{name:"English (South Africa)",value:"en-ZA"},{name:"English(UK)",value:"en-GB"},{name:"English(US)",value:"en-US"},{name:"Finnish",value:"fi"},{name:"French",value:"fr-FR"},{name:"Galician",value:"gl"},{name:"German",value:"de-DE"},{name:"Hebrew",value:"he"},{name:"Hungarian",value:"hu"},{name:"Icelandic",value:"is"},{name:"Italian",value:"it-IT"},{name:"Indonesian",value:"id"},{name:"Japanese",value:"ja"},{name:"Korean",value:"ko"},{name:"Latin",value:"la"},{name:"Mandarin Chinese",value:"zh-CN"},{name:"Traditional Taiwan",value:"zh-TW"},{name:"Simplified China",value:"zh-CN ?"},{name:"Simplified Hong Kong",value:"zh-HK"},{name:"Yue Chinese (Traditional Hong Kong)",value:"zh-yue"},{name:"Malaysian",value:"ms-MY"},{name:"Norwegian",value:"no-NO"},{name:"Polish",value:"pl"},{name:"Pig Latin",value:"xx-piglatin"},{name:"Portuguese",value:"pt-PT"},{name:"Portuguese (Brasil)",value:"pt-BR"},{name:"Romanian",value:"ro-RO"},{name:"Russian",value:"ru"},{name:"Serbian",value:"sr-SP"},{name:"Slovak",value:"sk"},{name:"Spanish (Argentina)",value:"es-AR"},{name:"Spanish (Bolivia)",value:"es-BO"},{name:"Spanish (Chile)",value:"es-CL"},{name:"Spanish (Colombia)",value:"es-CO"},{name:"Spanish (Costa Rica)",value:"es-CR"},{name:"Spanish (Dominican Republic)",value:"es-DO"},{name:"Spanish (Ecuador)",value:"es-EC"},{name:"Spanish (El Salvador)",value:"es-SV"},{name:"Spanish (Guatemala)",value:"es-GT"},{name:"Spanish (Honduras)",value:"es-HN"},{name:"Spanish (Mexico)",value:"es-MX"},{name:"Spanish (Nicaragua)",value:"es-NI"},{name:"Spanish (Panama)",value:"es-PA"},{name:"Spanish (Paraguay)",value:"es-PY"},{name:"Spanish (Peru)",value:"es-PE"},{name:"Spanish (Puerto Rico)",value:"es-PR"},{name:"Spanish (Spain)",value:"es-ES"},{name:"Spanish (US)",value:"es-US"},{name:"Spanish (Uruguay)",value:"es-UY"},{name:"Spanish (Venezuela)",value:"es-VE"},{name:"Swedish",value:"sv-SE"},{name:"Turkish",value:"tr"},{name:"Zulu",value:"zu"}]},this.storedSettings&&this.storedSettings.commands?(this.commands=this.storedSettings.commands,s.call(a,a.storedSettings.language)):this.commands=[],require([e+"js/annyang.min.js"],function(e){a.annyang=e,a.annyang.addCallback("soundstart",c.onSoundStarts,a),a.annyang.addCallback("resultNoMatch",c.onResultNoMatch,a),a.annyang.addCallback("error",function(a){console.log("Error: ",a)}),a.languages.items.some(function(e){!0===e.selected&&a.annyang.setLanguage(e.value)}),a.annyang_started=!1}),this.loadTemplate("properties.html").then(function(e){a.propTemplate=e})},c.hasMissingProperties=function(){return!1},c.onBeforeSave=function(){var a=i.getValues();return{commands:this.commands,language:a.Languages}},c.onExecute=function(a){this.commands.some(function(e){if(e.name==a.action)return console.log("Execute: ",a),!0})||console.log("The requested action doesn't exist")},c.onCancelProperties=function(){console.log("Cancelling Properties")},c.onSaveProperties=function(a){o.call(this)},c.onClick=function(){u.call(this)},c.onSoundStarts=function(){console.log("Sound started"),this.processData({soundstart:!0})},c.onBeforeDestroy=function(){this.annyang.abort(),this.annyang=void 0,annyang=void 0},c.onResultNoMatch=function(a){var e=this;a.some(function(a){var n=!0,i=!1,t=void 0;try{for(var s,o=e.commands[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var r=s.value;if(r.name.toLowerCase()==a.trim().toLowerCase()){console.log("Command recognized: ",r.name),e.processData({commandmatch:!0});var l={};return l[r.name.toLowerCase()]=!0,e.processData(l),!0}}}catch(a){i=!0,t=a}finally{try{!n&&o.return&&o.return()}finally{if(i)throw t}}})||(console.log("No match!"),this.processData({resultnomatch:!0}))},c.onNewData=function(){},c});